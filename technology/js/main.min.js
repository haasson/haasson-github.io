"use strict";function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function d(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}window.onload=function(){var e,t,n,o,i,r,s,c,a;function l(e){e.classList.remove("advantages__item_collapse")}console.log(this),document.body.classList.remove("loading"),svg4everybody(),function(){{if("function"==typeof NodeList.prototype.forEach)return;NodeList.prototype.forEach=Array.prototype.forEach}}(),document.body.classList.contains("main-page")?($(".select2").select2({minimumResultsForSearch:1/0,containerCssClass:"custom-select",dropdownCssClass:"custom-dropdown"}),new Swiper(".complex__slider",{autoHeight:!0,breakpoints:{1200:{slidesPerView:3,spaceBetween:30},992:{slidesPerView:2,spaceBetween:50},768:{slidesPerView:2,spaceBetween:40},568:{slidesPerView:1,spaceBetween:30},480:{slidesPerView:1,spaceBetween:20}},watchOverflow:!0,slidesPerView:1,spaceBetween:20,pagination:{el:".swiper-pagination",clickable:!0}}),t=document.querySelector(".form__cities"),n=t.closest("form").querySelector("input[name=city]"),t.addEventListener("click",function(e){var t=e.target.closest(".form__city").innerHTML;n.value=t}),document.querySelectorAll(".j-show-more").forEach(function(e){e.addEventListener("click",function(){e.closest(".advantages__list").querySelectorAll(".advantages__item_collapse").forEach(l),e.closest(".advantages__more").classList.add("hide")})})):(e=localStorage.getItem("tyText"),console.log(e),e&&(console.log("here"),document.querySelector(".success__text").innerHTML=e,localStorage.removeItem("tyText"))),$(".popup-default").magnificPopup({type:"inline",preloader:!1,showCloseBtn:!1,fixedContentPos:!0,fixedBgPos:!0,mainClass:"custom-mfp",callbacks:{open:function(){$(".p-close, .close-popup").on("click",function(e){e.preventDefault(),$.magnificPopup.close()})},change:function(){console.log("change"),window.scrollTo(0,h(this.container[0]).top),p.prevPopup=p.popupName,p.popupName=this.currItem.src},beforeClose:function(){}}}),ouibounce(null,{aggressive:!0,callback:function(){m("#exit")}}),function(){var c=function(){if(!("IntersectionObserver"in window))throw new Error("\n\t\t\tbounds.js requires IntersectionObserver on the global object.\n\t\t\tIntersectionObserver is unavailable in IE and other older\n\t\t\tversions of browsers.\n\t\t\tSee https://github.com/ChrisCavs/bounds.js/blob/master/README.md\n\t\t\tfor more compatibility information.\n\t\t  ")},a=function(e){var t=0<arguments.length&&void 0!==e?e:{},n=t.top,o=void 0===n?0:n,i=t.right,r=void 0===i?0:i,s=t.bottom,c=void 0===s?0:s,a=t.left,l=void 0===a?0:a;return"".concat(o,"px ").concat(r,"px ").concat(c,"px ").concat(l,"px")},l=function(){},e=function(){function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.root,n=e.margins,o=e.threshold,i=e.onEmit;u(this,s),c();var r={root:t||null,rootMargin:a(n),threshold:o||0};this.nodes=[],this.onEmit=i||l,this.observer=new IntersectionObserver(this._emit.bind(this),r)}return d(s,[{key:"watch",value:function(e,t,n){var o={el:e,onEnter:1<arguments.length&&void 0!==t?t:l,onLeave:2<arguments.length&&void 0!==n?n:l};return this.nodes.push(o),this.observer.observe(e),o}},{key:"unWatch",value:function(e){var t=this._findByNode(e,!0);return-1!==t&&(this.nodes.splice(t,1),this.observer.unobserve(e)),this}},{key:"check",value:function(e){return(this._findByNode(e)||{}).history}},{key:"clear",value:function(){return this.nodes=[],this.observer.disconnect(),this}},{key:"_emit",value:function(e){var o=this,t=e.map(function(e){var t=o._findByNode(e.target),n=e.intersectionRatio;return t.history=e.isIntersecting,e.isIntersecting?t.onEnter(n):t.onLeave(n),{el:e.target,inside:e.isIntersecting,outside:!e.isIntersecting,ratio:e.intersectionRatio}});this.onEmit(t)}},{key:"_findByNode",value:function(t,e){var n=1<arguments.length&&void 0!==e&&e?"findIndex":"find";return this.nodes[n](function(e){return e.el.isEqualNode(t)})}}],[{key:"checkCompatibility",value:function(){c()}}]),s}(),n=new e({margins:{bottom:1e3,top:1e3}});document.querySelectorAll("picture").forEach(function(e){var t;n.watch(e,(t=e,function(){var e=t.querySelector("img");t.querySelectorAll("source").forEach(function(e){return e.srcset=e.dataset.srcset}),e.src=e.dataset.src,n.unWatch(t)}))});var t=document.querySelector(".y-map");t&&n.watch(t,function(){var e=document.querySelector("#y-map-api");e.src=e.dataset.src,console.log(e),n.unWatch(t),setTimeout(function(){ymaps.ready(function(){var e=new ymaps.Map("map",{center:[55.9005,37.53],zoom:16,behaviors:["drag"],controls:["zoomControl"]});document.documentElement.clientWidth<=1300&&e.setCenter([55.900958,37.535035]),document.documentElement.clientWidth<=992&&(e.setCenter([55.902,37.54]),e.behaviors.disable("drag"),e.behaviors.enable("multiTouch"));var t=new ymaps.Placemark([55.90079,37.5405],{hintContent:"Технология"},{iconLayout:"default#image",iconImageHref:"svg/single/placemark.svg",iconImageSize:[58,64],iconImageOffset:[-29,-32]});e.geoObjects.add(t)})},1e3)});var o=window.navigator.userAgent.match(/Firefox\/([0-9]+)\./),i=o?parseInt(o[1]):0,r=document.querySelectorAll("[data-bg]");r&&r.forEach(function(e){var t;n.watch(e,(t=e,function(){var o="";t.dataset.bg.split(",").forEach(function(e){var t,n;n=v()||65<=i?(t=e.lastIndexOf("."),e.slice(0,t)+".webp"):e,o+="url(".concat(n,"), ")}),t.style.backgroundImage=o.slice(0,-2)}))});document.querySelectorAll("video").forEach(function(e){var o;n.watch(e,(o=e,function(){var e,t,n=o.dataset.poster;t=v()||65<=i?(e=n.lastIndexOf("."),n.slice(0,e)+".webp"):n,o.setAttribute("poster",t)}))})}(),function(){document.querySelector("#form-quiz")&&new y({formSelector:"#form-quiz",tooltips:!0,endpoints:!0});document.querySelector("#form-calc")&&new y({formSelector:"#form-calc",tooltips:!0,endpoints:!0,additionalTooltip:!0})}(),o=document.querySelectorAll("form"),i={phone:{type:"tel"},email:{pattern:/.+@.+\..+/i,type:"email"},name:{pattern:/^[а-яА-Я\s]{2,23}|[a-zA-Z\s]{2,30}$/,type:"text"}},o.forEach(function(e){new g({form:e,inputs:i,onSubmit:f})}),function(){var e=document.querySelectorAll(".tabs");if(!e.length)return;e.forEach(function(i){var r=i.parentElement,s=r.querySelectorAll(".tabs-content");i.addEventListener("click",function(e){var t=e.target.closest(".tabs-button"),n=t.getAttribute("data-tabs"),o=r.querySelector("#tab-".concat(n));i.querySelectorAll(".tabs-button").forEach(function(e){e.classList.remove("tabs-active")}),t.classList.add("tabs-active"),s.forEach(function(e){e.classList.add("hide")}),o.classList.remove("hide")})})}(),document.querySelectorAll(".play-btn").forEach(function(n){n.addEventListener("click",function(){var e=n.closest(".video-wrap").querySelector("video"),t=e.getAttribute("data-src");e.setAttribute("src",t),e.play(),n.style.display="none",e.setAttribute("controls",!0)})}),r=document.querySelector(".p-callback__form"),s=r.querySelector(".form__call-time"),c=r.querySelector("#time-now"),a=r.querySelector("#time-later"),s.addEventListener("focus",function(){c.removeAttribute("checked"),a.setAttribute("checked",!0)}),s.addEventListener("blur",function(){""===s.value&&(a.removeAttribute("checked"),c.setAttribute("checked",!0))}),$("input[type=tel]").mask("+7 999 999 9999",{autoclear:!1}),document.querySelector(".current-year").innerHTML=(new Date).getFullYear()};var p={};function f(e){var t=e.getAttribute("data-popup"),n=e.getAttribute("data-route");if("form-quiz"===e.id||"form-calc"===e.id)return p.formData=$(e).serialize(),void m("#".concat(t),{open:i});var o=("form-p-choosing"===e.id?p.formData+"&":"")+$(e).serialize();!function(e){var t;"form-p-callback"===e||"form-consult"===e||"form-p-testdrive"===e?t="Мы получили вашу заявку и в скором времени вам позвоним":"form-p-choosing"===e?t="Мы получили вашу заявку и в скором времени пришлём вам подбор оборудования и расчет окупаемости":"form-p-leasing"===e?t="Мы получили вашу заявку и в скором времени пришлём вам комплект документов":"form-tradein"===e&&(t="Мы получили вашу заявку и в скором времени пришлём вам расчет стоимости оборудования");t&&localStorage.setItem("tyText",t)}(e.id),$.ajax({url:"send.php",method:"POST",data:decodeURI(o),success:function(e){console.log("success"),console.log(e)},error:function(e){alert("error - "+e.status)},complete:function(){console.log(this.data),p.formData=null,t&&m("#".concat(t)),n&&(window.location="./".concat(n,".html"))}})}function m(e,t){$.magnificPopup.open({type:"inline",mainClass:"custom-mfp",items:{src:e},preloader:!0,showCloseBtn:!1,fixedContentPos:!0,fixedBgPos:!0,callbacks:{open:function(){$(".p-close, .close-popup").on("click",function(e){e.preventDefault(),$.magnificPopup.close()}),t&&t.open&&t.open()},change:function(){window.scrollTo(0,h(this.container[0]).top),p.prevPopup=p.popupName,p.popupName=this.currItem.src},beforeClose:function(){"#policy"===this.currItem.src&&setTimeout(function(){m(p.prevPopup)},0)}}},0)}function i(){var e=document.querySelector(".p-choosing"),s=e.querySelector(".p-choosing__first"),c=e.querySelector(".p-choosing__second"),a=e.querySelector(".progress__active"),l=e.querySelector(".progress__point"),u=e.querySelector(".progress-value"),t=document.querySelectorAll(".content__item"),d=100/t.length;!function e(t,n){var o=t[n];var i=n===t.length-1;var r=Math.ceil((n+1)*d);0===n&&(t.forEach(function(e){e.classList.remove("content__item_active","content__item_done"),a.style.width=0,l.style.left=0,u.innerHTML="0%"}),s.classList.remove("hide"),c.classList.add("hide"));o.classList.add("content__item_active");setTimeout(function(){i?(s.classList.add("hide"),c.classList.remove("hide")):(o.classList.remove("content__item_active"),o.classList.add("content__item_done"),a.style.width="".concat(r,"%"),l.style.left=0===r?"0px":"calc(".concat(r,"% - 23px)"),u.innerHTML="".concat(r,"%"),e(t,n+1))},i?4e3:2e3)}(t,0)}function h(e){var t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset,left:t.left+window.pageXOffset}}function v(){var e=document.createElement("canvas");return e.getContext&&e.getContext("2d")&&0==e.toDataURL("image/webp").indexOf("data:image/webp")}Element.prototype.closest||(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest=function(e){var t=this;if(!document.documentElement.contains(this))return null;do{if(t.matches(e))return t;t=t.parentElement}while(null!==t);return null});var y=function(){function t(e){u(this,t),this.form=document.querySelector(e.formSelector),this.tooltips=e.tooltips||!1,this.decimals=e.decimals||0,this.endpoints=e.endpoints,this.additionalTooltip=e.additionalTooltip,this.run()}return d(t,[{key:"run",value:function(){this.createRange()}},{key:"createRange",value:function(){var a=this;this.form.querySelectorAll("input[type=range]").forEach(function(t){var e=t.getAttribute("name"),n=+t.getAttribute("min"),o=+t.getAttribute("max"),i=+t.getAttribute("value"),r=+t.getAttribute("step"),s=t.getAttribute("class"),c=document.createElement("div");c.classList.add(s,"".concat(s,"_").concat(e)),t.insertAdjacentHTML("afterend",c.outerHTML),t.classList.add("hide"),a.additionalTooltip&&a.setAdditionalValue(t,i),noUiSlider.create(a.form.querySelector(".".concat(s,"_").concat(e)),{start:i,range:{min:[n],max:[o]},step:r,tooltips:a.tooltips,format:wNumb({decimals:a.decimals,thousand:" "})}).on("change",function(e){t.setAttribute("value",e[0]),a.additionalTooltip&&a.setAdditionalValue(t,e[0])}),a.endpoints&&a.addEndpoint(t,n,o)})}},{key:"addEndpoint",value:function(e,t,n){var o=e.closest(".form__input").querySelectorAll(".form__input-endpoint"),i=wNumb({thousand:" "});o.forEach(function(e){e.classList.contains("start")?e.innerHTML=i.to(t):e.classList.contains("end")&&(e.innerHTML=i.to(n))})}},{key:"setAdditionalValue",value:function(e,t){e.closest(".form__input").querySelector(".form__range-table").innerHTML=t}}]),t}(),g=function(){function t(e){u(this,t),this.form=e.form,this.submitBtn=this.form.querySelector('[type="submit"]'),this.onSubmit=e.onSubmit,this.inputs=e.inputs,this.inputsCount=0,this.validInputs=new Map,this.run()}return d(t,[{key:"run",value:function(){this.validate(),this.submit()}},{key:"validate",value:function(){var o=this;for(var e in this.inputs)!function(e){var n=o.inputs[e],t=o.form.querySelectorAll(".input:not(.no-validate) input[type=".concat(n.type,"]"));o.inputsCount+=t.length,t.forEach(function(e){var t=e.closest(".input");e.addEventListener("focus",function(){t.classList.remove("inp-error")}),"tel"===n.type?e.addEventListener("keyup",function(){-1===e.value.indexOf("_")?o.setInputOk(t):o.setInputError(t)}):e.addEventListener("keyup",function(){e.value.match(n.pattern)?o.setInputOk(t):o.setInputError(t)})})}(e)}},{key:"setInputOk",value:function(e){e.classList.add("inp-ok"),this.validInputs.set(e,null),this.checkValidInputsCount()}},{key:"setInputError",value:function(e){e.classList.remove("inp-ok"),this.validInputs.delete(e,null),this.checkValidInputsCount()}},{key:"checkValidInputsCount",value:function(){this.inputsCount==this.validInputs.size?this.submitBtn.classList.add("form-valid"):this.submitBtn.classList.remove("form-valid")}},{key:"submit",value:function(){var t=this;this.form.addEventListener("submit",function(e){e.preventDefault(),t.submitBtn.classList.contains("form-valid")||0===t.inputsCount?t.onSubmit(t.form):t.form.querySelectorAll(".input:not(.no-validate)").forEach(function(e){e.classList.contains("inp-ok")||e.classList.add("inp-error")})})}}]),t}();