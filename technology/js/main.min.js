"use strict";function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function d(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}window.onload=function(){var t,e,n,o,i,r,s,c,a;function l(t){t.classList.remove("advantages__item_collapse")}console.log(this),document.body.classList.remove("loading"),svg4everybody(),function(){{if("function"==typeof NodeList.prototype.forEach)return;NodeList.prototype.forEach=Array.prototype.forEach}}(),document.body.classList.contains("main-page")?($(".select2").select2({minimumResultsForSearch:1/0,containerCssClass:"custom-select",dropdownCssClass:"custom-dropdown"}),new Swiper(".complex__slider",{autoHeight:!0,breakpoints:{1200:{slidesPerView:3,spaceBetween:30},992:{slidesPerView:2,spaceBetween:50},768:{slidesPerView:2,spaceBetween:40},568:{slidesPerView:1,spaceBetween:30},480:{slidesPerView:1,spaceBetween:20}},watchOverflow:!0,slidesPerView:1,spaceBetween:20,pagination:{el:".swiper-pagination",clickable:!0}}),e=document.querySelector(".form__cities"),n=e.closest("form").querySelector("input[name=city]"),e.addEventListener("click",function(t){var e=t.target.closest(".form__city").innerHTML;n.value=e}),document.querySelectorAll(".j-show-more").forEach(function(t){t.addEventListener("click",function(){t.closest(".advantages__list").querySelectorAll(".advantages__item_collapse").forEach(l),t.closest(".advantages__more").classList.add("hide")})}),function(){var c=function(){if(!("IntersectionObserver"in window))throw new Error("\n\t\t\tbounds.js requires IntersectionObserver on the global object.\n\t\t\tIntersectionObserver is unavailable in IE and other older\n\t\t\tversions of browsers.\n\t\t\tSee https://github.com/ChrisCavs/bounds.js/blob/master/README.md\n\t\t\tfor more compatibility information.\n\t\t  ")},a=function(t){var e=0<arguments.length&&void 0!==t?t:{},n=e.top,o=void 0===n?0:n,i=e.right,r=void 0===i?0:i,s=e.bottom,c=void 0===s?0:s,a=e.left,l=void 0===a?0:a;return"".concat(o,"px ").concat(r,"px ").concat(c,"px ").concat(l,"px")},l=function(){},t=function(){function s(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.root,n=t.margins,o=t.threshold,i=t.onEmit;u(this,s),c();var r={root:e||null,rootMargin:a(n),threshold:o||0};this.nodes=[],this.onEmit=i||l,this.observer=new IntersectionObserver(this._emit.bind(this),r)}return d(s,[{key:"watch",value:function(t,e,n){var o={el:t,onEnter:1<arguments.length&&void 0!==e?e:l,onLeave:2<arguments.length&&void 0!==n?n:l};return this.nodes.push(o),this.observer.observe(t),o}},{key:"unWatch",value:function(t){var e=this._findByNode(t,!0);return-1!==e&&(this.nodes.splice(e,1),this.observer.unobserve(t)),this}},{key:"check",value:function(t){return(this._findByNode(t)||{}).history}},{key:"clear",value:function(){return this.nodes=[],this.observer.disconnect(),this}},{key:"_emit",value:function(t){var o=this,e=t.map(function(t){var e=o._findByNode(t.target),n=t.intersectionRatio;return e.history=t.isIntersecting,t.isIntersecting?e.onEnter(n):e.onLeave(n),{el:t.target,inside:t.isIntersecting,outside:!t.isIntersecting,ratio:t.intersectionRatio}});this.onEmit(e)}},{key:"_findByNode",value:function(e,t){var n=1<arguments.length&&void 0!==t&&t?"findIndex":"find";return this.nodes[n](function(t){return t.el.isEqualNode(e)})}}],[{key:"checkCompatibility",value:function(){c()}}]),s}(),n=new t({margins:{bottom:1e3,top:1e3}});document.querySelectorAll("picture").forEach(function(t){var e;n.watch(t,(e=t,function(){var t=e.querySelector("img");e.querySelectorAll("source").forEach(function(t){return t.srcset=t.dataset.srcset}),t.src=t.dataset.src,n.unWatch(e)}))});var e=document.querySelector(".y-map");n.watch(e,function(){var t=document.querySelector("#y-map-api");t.src=t.dataset.src,console.log(t),n.unWatch(e),setTimeout(function(){ymaps.ready(function(){var t=new ymaps.Map("map",{center:[55.9005,37.53],zoom:16,behaviors:["drag"],controls:["zoomControl"]});document.documentElement.clientWidth<=1300&&t.setCenter([55.900958,37.535035]),document.documentElement.clientWidth<=992&&(t.setCenter([55.902,37.54]),t.behaviors.disable("drag"),t.behaviors.enable("multiTouch"));var e=new ymaps.Placemark([55.90079,37.5405],{hintContent:"Технология"},{iconLayout:"default#image",iconImageHref:"svg/single/placemark.svg",iconImageSize:[58,64],iconImageOffset:[-29,-32]});t.geoObjects.add(e)})},1e3)}),document.querySelectorAll("[data-bg]").forEach(function(t){var e;n.watch(t,(e=t,function(){var o="";e.dataset.bg.split(",").forEach(function(t){var e=t.lastIndexOf("."),n=t.slice(0,e)+".webp";o+="url(".concat(n,"), ")}),e.style.backgroundImage=o.slice(0,-2)}))}),document.querySelectorAll("video").forEach(function(t){var o;n.watch(t,(o=t,function(){var t=o.dataset.poster,e=t.lastIndexOf("."),n=t.slice(0,e)+".webp";o.setAttribute("poster",n)}))})}()):(t=localStorage.getItem("tyText"),console.log(t),t&&(console.log("here"),document.querySelector(".success__text").innerHTML=t,localStorage.removeItem("tyText"))),$(".popup-default").magnificPopup({type:"inline",preloader:!1,showCloseBtn:!1,fixedContentPos:!0,fixedBgPos:!0,mainClass:"custom-mfp",callbacks:{open:function(){$(".p-close, .close-popup").on("click",function(t){t.preventDefault(),$.magnificPopup.close()})},change:function(){console.log("change"),window.scrollTo(0,m(this.container[0]).top),p.prevPopup=p.popupName,p.popupName=this.currItem.src},beforeClose:function(){}}}),function(){document.querySelector("#form-quiz")&&new h({formSelector:"#form-quiz",tooltips:!0,endpoints:!0});document.querySelector("#form-calc")&&new h({formSelector:"#form-calc",tooltips:!0,endpoints:!0,additionalTooltip:!0})}(),o=document.querySelectorAll("form"),i={phone:{type:"tel"},email:{pattern:/.+@.+\..+/i,type:"email"},name:{pattern:/^[а-яА-Я\s]{2,23}|[a-zA-Z\s]{2,30}$/,type:"text"}},o.forEach(function(t){new v({form:t,inputs:i,onSubmit:f})}),function(){var t=document.querySelectorAll(".tabs");if(!t.length)return;t.forEach(function(i){var r=i.parentElement,s=r.querySelectorAll(".tabs-content");i.addEventListener("click",function(t){var e=t.target.closest(".tabs-button"),n=e.getAttribute("data-tabs"),o=r.querySelector("#tab-".concat(n));i.querySelectorAll(".tabs-button").forEach(function(t){t.classList.remove("tabs-active")}),e.classList.add("tabs-active"),s.forEach(function(t){t.classList.add("hide")}),o.classList.remove("hide")})})}(),document.querySelectorAll(".play-btn").forEach(function(n){n.addEventListener("click",function(){var t=n.closest(".video-wrap").querySelector("video"),e=t.getAttribute("data-src");t.setAttribute("src",e),t.play(),n.style.display="none",t.setAttribute("controls",!0)})}),r=document.querySelector(".p-callback__form"),s=r.querySelector(".form__call-time"),c=r.querySelector("#time-now"),a=r.querySelector("#time-later"),s.addEventListener("focus",function(){c.removeAttribute("checked"),a.setAttribute("checked",!0)}),s.addEventListener("blur",function(){""===s.value&&(a.removeAttribute("checked"),c.setAttribute("checked",!0))}),$("input[type=tel]").mask("+7 999 999 9999",{autoclear:!1}),document.querySelector(".current-year").innerHTML=(new Date).getFullYear()};var p={};function f(t){var e=t.getAttribute("data-popup"),n=t.getAttribute("data-route");if("form-quiz"===t.id||"form-calc"===t.id)return p.formData=$(t).serialize(),void i("#".concat(e),{open:r});var o=("form-p-choosing"===t.id?p.formData+"&":"")+$(t).serialize();!function(t){var e;"form-p-callback"===t||"form-consult"===t||"form-p-testdrive"===t?e="Мы получили вашу заявку и в скором времени вам позвоним":"form-p-choosing"===t?e="Мы получили вашу заявку и в скором времени пришлём вам подбор оборудования и расчет окупаемости":"form-p-leasing"===t?e="Мы получили вашу заявку и в скором времени пришлём вам комплект документов":"form-tradein"===t&&(e="Мы получили вашу заявку и в скором времени пришлём вам расчет стоимости оборудования");e&&localStorage.setItem("tyText",e)}(t.id),$.ajax({url:"send.php",method:"POST",data:decodeURI(o),success:function(t){console.log("success"),console.log(t)},error:function(t){alert("error - "+t.status)},complete:function(){console.log(this.data),p.formData=null,e&&i("#".concat(e)),n&&(window.location="./".concat(n,".html"))}})}function i(t,e){$.magnificPopup.open({type:"inline",mainClass:"custom-mfp",items:{src:t},preloader:!0,showCloseBtn:!1,fixedContentPos:!0,fixedBgPos:!0,callbacks:{open:function(){$(".p-close, .close-popup").on("click",function(t){t.preventDefault(),$.magnificPopup.close()}),e&&e.open&&e.open()},change:function(){window.scrollTo(0,m(this.container[0]).top),p.prevPopup=p.popupName,p.popupName=this.currItem.src},beforeClose:function(){"#policy"===this.currItem.src&&setTimeout(function(){i(p.prevPopup)},0)}}},0)}function r(){var t=document.querySelector(".p-choosing"),s=t.querySelector(".p-choosing__first"),c=t.querySelector(".p-choosing__second"),a=t.querySelector(".progress__active"),l=t.querySelector(".progress__point"),u=t.querySelector(".progress-value"),e=document.querySelectorAll(".content__item"),d=100/e.length;!function t(e,n){var o=e[n];var i=n===e.length-1;var r=Math.ceil((n+1)*d);0===n&&(e.forEach(function(t){t.classList.remove("content__item_active","content__item_done"),a.style.width=0,l.style.left=0,u.innerHTML="0%"}),s.classList.remove("hide"),c.classList.add("hide"));o.classList.add("content__item_active");setTimeout(function(){i?(s.classList.add("hide"),c.classList.remove("hide")):(o.classList.remove("content__item_active"),o.classList.add("content__item_done"),a.style.width="".concat(r,"%"),l.style.left=0===r?"0px":"calc(".concat(r,"% - 23px)"),u.innerHTML="".concat(r,"%"),t(e,n+1))},i?4e3:2e3)}(e,0)}function m(t){var e=t.getBoundingClientRect();return{top:e.top+window.pageYOffset,left:e.left+window.pageXOffset}}Element.prototype.closest||(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest=function(t){var e=this;if(!document.documentElement.contains(this))return null;do{if(e.matches(t))return e;e=e.parentElement}while(null!==e);return null});var h=function(){function e(t){u(this,e),this.form=document.querySelector(t.formSelector),this.tooltips=t.tooltips||!1,this.decimals=t.decimals||0,this.endpoints=t.endpoints,this.additionalTooltip=t.additionalTooltip,this.run()}return d(e,[{key:"run",value:function(){this.createRange()}},{key:"createRange",value:function(){var a=this;this.form.querySelectorAll("input[type=range]").forEach(function(e){var t=e.getAttribute("name"),n=+e.getAttribute("min"),o=+e.getAttribute("max"),i=+e.getAttribute("value"),r=+e.getAttribute("step"),s=e.getAttribute("class"),c=document.createElement("div");c.classList.add(s,"".concat(s,"_").concat(t)),e.insertAdjacentHTML("afterend",c.outerHTML),e.classList.add("hide"),a.additionalTooltip&&a.setAdditionalValue(e,i),noUiSlider.create(a.form.querySelector(".".concat(s,"_").concat(t)),{start:i,range:{min:[n],max:[o]},step:r,tooltips:a.tooltips,format:wNumb({decimals:a.decimals,thousand:" "})}).on("change",function(t){e.setAttribute("value",t[0]),a.additionalTooltip&&a.setAdditionalValue(e,t[0])}),a.endpoints&&a.addEndpoint(e,n,o)})}},{key:"addEndpoint",value:function(t,e,n){var o=t.closest(".form__input").querySelectorAll(".form__input-endpoint"),i=wNumb({thousand:" "});o.forEach(function(t){t.classList.contains("start")?t.innerHTML=i.to(e):t.classList.contains("end")&&(t.innerHTML=i.to(n))})}},{key:"setAdditionalValue",value:function(t,e){t.closest(".form__input").querySelector(".form__range-table").innerHTML=e}}]),e}(),v=function(){function e(t){u(this,e),this.form=t.form,this.submitBtn=this.form.querySelector('[type="submit"]'),this.onSubmit=t.onSubmit,this.inputs=t.inputs,this.inputsCount=0,this.validInputs=new Map,this.run()}return d(e,[{key:"run",value:function(){this.validate(),this.submit()}},{key:"validate",value:function(){var o=this;for(var t in this.inputs)!function(t){var n=o.inputs[t],e=o.form.querySelectorAll(".input:not(.no-validate) input[type=".concat(n.type,"]"));o.inputsCount+=e.length,e.forEach(function(t){var e=t.closest(".input");t.addEventListener("focus",function(){e.classList.remove("inp-error")}),"tel"===n.type?t.addEventListener("keyup",function(){-1===t.value.indexOf("_")?o.setInputOk(e):o.setInputError(e)}):t.addEventListener("keyup",function(){t.value.match(n.pattern)?o.setInputOk(e):o.setInputError(e)})})}(t)}},{key:"setInputOk",value:function(t){t.classList.add("inp-ok"),this.validInputs.set(t,null),this.checkValidInputsCount()}},{key:"setInputError",value:function(t){t.classList.remove("inp-ok"),this.validInputs.delete(t,null),this.checkValidInputsCount()}},{key:"checkValidInputsCount",value:function(){this.inputsCount==this.validInputs.size?this.submitBtn.classList.add("form-valid"):this.submitBtn.classList.remove("form-valid")}},{key:"submit",value:function(){var e=this;this.form.addEventListener("submit",function(t){t.preventDefault(),e.submitBtn.classList.contains("form-valid")||0===e.inputsCount?e.onSubmit(e.form):e.form.querySelectorAll(".input:not(.no-validate)").forEach(function(t){t.classList.contains("inp-ok")||t.classList.add("inp-error")})})}}]),e}();